<h1>Test program for Nedelec finite elements</h1>

<h2> Introduction </h2>
This program can be used for verification of the pull "Nedelec orientation fix nr.1".

<h2> Operation </h2>
The program projects a manufactured magnetic vector potential, $\vec{A}$, onto the 
space spanned by the shape functions of the Nedelec finite elements and computes the
$L^2$ error norm. The meshes are generated by the non_standard_orientation_mesh()
function of deal.II. The idea for verification is the following. We compute the $L^2$ 
error norms for all possible orientations of the shared face in 2D and in 3D for
Nedelec finite elements of degree 0, 1, 2, 3, and 4. If the order of the rate of the 
convergence of the $L^2$ error norm is approximately equals the order of the finite 
element plus two, $\approx p+2$, we assume that the finite elements pass the 
verification test until the next bug is discovered.

The manufactured magnetic vector potential is computed as 

$\vec{A}_{2D} = \dfrac{1}{k}\big(-\sin{(ky)}\hat{i} + \sin{(kx)} \hat{j}\big)$

in 2D and as 

$\vec{A}_{3D} = \dfrac{1}{k}\big(-\sin{(ky)}\hat{i} + \sin{(kx)} \hat{j} + 0 \hat{k} \big) $

in 3D, where  

$k = \dfrac{\pi}{2} $.

The following figure illustrates the convergence tables calculated  by the
program compiled against the old and the new (patched) versions of the library. 

![][figure]

One can observe that the order of the rate of convergence (the last column)
equals $\approx p+2$ if the new version is used. So, we can assume that the
Nedelec finite elements in this particular configuration are working fine.

All controls of the test-nedelec program are located in the last line of the
[CMakeLists.txt]():

    target_compile_options(${TARGET} PRIVATE -DDIMENSION__=2 -DFACEORIENTATION__=1)

The macro definition DIMENSION__ can take two values: 2 and 3.  It corresponds to the parameter dim
in deal.II.

The macro definition FACEORIENTATION__ in two dimensions encodes the orientation of the middle cell,
see the documentation of non_standard_orientation_mesh(). In three dimensions the macro definition
FACEORIENTATION__ can take the following values: 0, 1, 2, 3, 4, 5, 6, or 7. This numbers are
the combined orientation and are computed as

    orientation_no = face_flip*4 + face_rotation*2 + face_orientation*1;

See
[tria_orientation.h](https://github.com/dealii/dealii/blob/master/include/deal.II/grid/tria_orientation.h).
The three boolean parameters in the last equation have the following meaning:

>face_orientation - true if face is in standard orientation and false otherwise;  
>face_rotation - rotation by 90 deg counterclockwise if true;  
>face_flip - rotation by 180 deg counterclockwise if true.  

See the documentation of
[GeometryInfo<dim>](https://dealii.org/current/doxygen/deal.II/structGeometryInfo.html)

and documentation of non_standard_orientation_mesh().

[figure]: doc/figure.svg

